const Events = require('events');
const { sleep } = require('powercord/util');

module.exports = class Plugin extends Events {
  constructor (options = {}) {
    super();

    this.options = {
      dependencies: [],
      appMode: 'app',
      ...options
    };

    this.ready = false;
  }

  async _start () {
    while (!this.options.dependencies.every(pluginName => (
      powercord.plugins.get(pluginName).ready
    ))) {
      await sleep(1);
    }

    await this.start();
    this.ready = true;
    this.log('Plugin started');
  }

  log (...data) {
    console.log(`%c[Powercord:${this.constructor.name}]`, 'color: #257dd4', ...data)
  }

  warn (...data) {
    console.warn(`%c[Powercord:${this.constructor.name}]`, 'color: #257dd4', ...data)
  }

  error (...data) {
    console.error(`%c[Powercord:${this.constructor.name}]`, 'color: #257dd4', ...data)
  }
};
