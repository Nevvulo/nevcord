const { React } = require('powercord/webpack');
const SliderItem = require('./Slider.jsx');
const ButtonItem = require('./Button.jsx');
const SubmenuItem = require('./Submenu.jsx');
const CheckboxItem = require('./Checkbox.jsx');

module.exports = class ContextMenu extends React.Component {
  render () {
    let hasSubmenu;

    const children = this.props.itemGroups.map(items => (
      <div className='itemGroup-1tL0uz'>
        {items.map(item => {
          switch (item.type) {
            case 'slider':
              return <SliderItem {...item} />;
            
            case 'button':
              return <ButtonItem {...item} />;

            case 'submenu':
              hasSubmenu = true;
              return <SubmenuItem {...item} />;

            case 'checkbox':
              return <CheckboxItem {...item} />;
          }
        })}
      </div>
    ));

    const childrenLength = this.props.itemGroups
      .map(r => r.length)
      .reduce((a, b) => a + b);

    const wrappedChildren = hasSubmenu | !(childrenLength > 10)
      ? children
      : (
        <div className='scrollerWrap-2lJEkd firefoxFixScrollFlex-cnI2ix scrollerThemed-2oenus themeGhostHairline-DBD-2d'>
          <div className='scroller-2FKFPG firefoxFixScrollFlex-cnI2ix scroller-2PSBSf'>
            {children}
          </div>
        </div>
      );

    return (
      <div className='contextMenu-HLZMGh theme-dark' style={{
        bottom: `${window.innerHeight - this.props.pageY}px`,
        left: `${this.props.pageX}px`,
        width: this.props.width
      }}>
        {wrappedChildren}
      </div>
    )
  }
}